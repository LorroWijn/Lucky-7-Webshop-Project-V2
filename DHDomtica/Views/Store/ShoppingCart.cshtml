@model IEnumerable<DHDomtica.Models.Product>
@using DHDomtica.Models


@{
    ViewBag.Title = "ShoppingCart";
}

<h2>ShoppingCart</h2>
<h3>@ViewBag.Message</h3>
<table class="table">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.Name)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Description)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Price)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Image)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.MainCategory.Name)
        </th>
        <th>
            @Html.Label("Aantal")
        </th>
        <th>
            @Html.Label("Prijs")
        </th>
        <th></th>
    </tr>

    @if ((List<ItemModel>)Session["cart"] != null)
    {
        foreach (ItemModel item in (List<ItemModel>)Session["cart"])
        {
            <tr onclick="location.href = '@(Url.Action("ProductDetails", "Store", new { id = item.Product.ID }))'" style="cursor:pointer;">

                <td>@item.Product.Name</td>
                @{ string ShorterString = item.Product.Description;
                    if (ShorterString.Length > 100)
                    {
                        ShorterString = ShorterString.Substring(0, 100);
                    }
                }
                <td>@ShorterString</td>
                <td>€@item.Product.Price</td>
                <td><img class="card-img-top img-fluid" src="@item.Product.Image" alt="Image"></td>
                <td>@item.Product.MainCategory.Name</td>
                <td>@item.Quantity</td>
                <td>€@(item.Product.Price * item.Quantity)</td>

            </tr>
                    }

    <tr>
        <td align="right" colspan="6">Totaal</td>
        <td>
            @{
                List<ItemModel> products = (List<ItemModel>)Session["cart"];
                var total = products.Sum(item => item.Product.Price * item.Quantity);
            }
            €@total
        </td>
    </tr>
                }
</table>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}
